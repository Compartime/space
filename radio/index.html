<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radio Zeno Espectacular</title>
    <!-- Incluye una fuente más script/decorativa para "Pura Vida" y Orbitron para el resto -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Pacifico&display=swap" rel="stylesheet">
    <!-- Iconos de FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Variables y base */
        :root {
            --neon-blue: #00e0ff;
            --neon-pink: #ff00c8;
            --dark-bg: #0d0d1d;
            --med-bg: #1a1a38;
            --light-text: #f0f0f0;
        }

        body, html {
            height: 100%;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--dark-bg);
            font-family: 'Orbitron', sans-serif;
            color: var(--light-text);
            overflow: hidden;
            background-image: radial-gradient(circle at center, var(--med-bg) 0%, var(--dark-bg) 70%);
        }

        /* Estructura principal - Rectangular en PC, Fullscreen en Móvil */
        .radio-player {
            width: 95vw;
            max-width: 800px; 
            height: auto; 
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            background: rgba(10, 10, 30, 0.5);
            border-radius: 30px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(0, 224, 255, 0.2);
            /* Outer glow and Inner directional glow for top/bottom */
            box-shadow: 
                0 0 25px rgba(0, 224, 255, 0.5), 
                0 0 40px rgba(255, 0, 200, 0.3),
                inset 0 5px 15px rgba(0, 224, 255, 0.7),   /* Top energy */
                inset 0 -5px 15px rgba(255, 0, 200, 0.7);  /* Bottom energy */
            transition: all 0.5s ease-in-out;
            position: relative; 
            overflow: visible; 
        }
        
        /* Efecto de Pulso General del Reproductor cuando está 'playing' */
        .radio-player.playing {
             animation: player-glow-pulse 1.5s infinite alternate;
        }
        
        @keyframes player-glow-pulse {
            0% {
                box-shadow: 
                    0 0 25px rgba(0, 224, 255, 0.5), 
                    0 0 40px rgba(255, 0, 200, 0.3),
                    inset 0 5px 15px rgba(0, 224, 255, 0.7),
                    inset 0 -5px 15px rgba(255, 0, 200, 0.7);
            }
            100% {
                box-shadow: 
                    0 0 40px rgba(0, 224, 255, 0.7), 
                    0 0 70px rgba(255, 0, 200, 0.5),
                    inset 0 8px 25px rgba(0, 224, 255, 0.9),
                    inset 0 -8px 25px rgba(255, 0, 200, 0.9);
            }
        }
        
        /* Estilos para los efectos de Rayos/Energía en los bordes verticales (Laterales) */
        .radio-player::before,
        .radio-player::after {
            content: '';
            position: absolute;
            top: 5%;
            height: 90%; 
            width: 8px; 
            z-index: -1; 
            opacity: 0.7;
            border-radius: 4px; 
            
            background: linear-gradient(to top, var(--neon-pink) 0%, var(--neon-blue) 100%);
            box-shadow: 0 0 10px var(--neon-blue);
            animation: ray-flicker 5s infinite alternate ease-in-out;
            transition: all 0.5s;
        }

        .radio-player::before {
            left: -10px; 
            transform: scaleY(1);
            animation-delay: 0s;
        }

        .radio-player::after {
            right: -10px; 
            transform: scaleY(1.05);
            animation-delay: 2.5s; 
        }
        
        /* Simular un efecto de parpadeo (flicker) o flujo en los rayos */
        @keyframes ray-flicker {
            0% {
                opacity: 0.7;
                transform: scaleY(1);
                box-shadow: 0 0 10px var(--neon-blue);
            }
            50% {
                opacity: 0.9;
                transform: scaleY(1.03);
                box-shadow: 0 0 15px var(--neon-pink);
            }
            100% {
                opacity: 0.8;
                transform: scaleY(1);
                box-shadow: 0 0 10px var(--neon-blue);
            }
        }
        
        /* Aumentar el brillo de los rayos verticales cuando está reproduciendo */
        .radio-player.playing::before,
        .radio-player.playing::after {
             box-shadow: 0 0 25px var(--neon-blue), 0 0 50px var(--neon-pink);
        }

        /* Información de fecha y hora */
        .metadata-top {
            width: 100%;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 0 5px var(--neon-blue);
        }

        .metadata-top div {
            font-size: 0.8em;
            margin: 2px 0;
        }

        /* Área central: Carátula / Visualizador */
        .visualizer-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            width: 100%;
            margin-top: 10px;
            margin-bottom: 10px; 
            position: relative;
        }

        /* Contenedor del Orbe */
        #orb-wrapper {
            width: min(35vh, 280px);
            height: min(35vh, 280px); 
            position: relative;
            margin: 10px auto; 
        }
        
        /* El Orbe Visualizador */
        #visualizer-orb {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%; 
            background: radial-gradient(circle, rgba(0, 224, 255, 0.4) 0%, rgba(255, 0, 200, 0.4) 100%);
            box-shadow: 
                0 0 40px var(--neon-blue), 
                0 0 80px var(--neon-pink),
                inset 0 0 20px var(--light-text);
            animation: orb-color-shift 10s infinite alternate, orb-pulse 1.5s infinite alternate;
            opacity: 0.8;
            transition: all 0.5s;
        }

        /* Animaciones del Orbe */
        @keyframes orb-color-shift {
            0% { box-shadow: 0 0 40px var(--neon-blue), 0 0 80px var(--neon-pink), inset 0 0 20px var(--light-text); }
            100% { box-shadow: 0 0 80px var(--neon-pink), 0 0 40px var(--neon-blue), inset 0 0 20px var(--light-text); }
        }

        @keyframes orb-pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.03); }
        }
        
        .radio-player.playing #visualizer-orb {
            animation: orb-color-shift 10s infinite alternate, orb-pulse-active 0.4s infinite alternate; 
        }
        
        @keyframes orb-pulse-active {
            0% { transform: scale(1); opacity: 1;}
            100% { transform: scale(1.05); opacity: 0.9;}
        }

        /* Contenedor Marquee para el Título */
        .marquee-container {
            width: 90%;
            max-width: 400px;
            overflow: hidden; 
            position: relative;
            height: 55px; 
            margin-top: 15px;
        }

        /* Título de la canción */
        #song-title {
            font-size: 1.5em;
            font-weight: 700;
            white-space: nowrap; 
            text-shadow: 0 0 10px var(--neon-pink);
            
            /* ESTILO POR DEFECTO PARA TÍTULOS CORTOS (CENTRADO) */
            position: relative; 
            width: 100%;
            text-align: center;
            display: block; 
            left: 0;
            top: 50%; 
            transform: translateY(-50%); 
        }

        /* ESTILO ACTIVO PARA TÍTULOS LARGOS (MARQUESINA) */
        .marquee-active #song-title {
            position: absolute; 
            left: 100%; 
            width: fit-content;
            display: inline-block;
            text-align: left;
            padding-right: 20px; 
            animation: marquee 15s linear infinite; 
            animation-duration: var(--scroll-duration);
            
            top: 50%;
            transform: translateY(-50%);
        }
        
        /* Animación Marquee */
        @keyframes marquee {
            from { transform: translate(0, -50%); } 
            to { transform: translate(var(--scroll-distance), -50%); } 
        }
        
        /* --- ESTILO "PURA VIDA" --- */
        #pura-vida-text {
            font-family: 'Pacifico', cursive; /* Fuente script para el toque espectacular */
            font-size: 2.2em; /* Tamaño grande */
            font-weight: 400;
            color: var(--light-text);
            margin: 10px 0 20px 0; /* Espacio debajo del título y sobre los controles */
            text-align: center;
            
            /* Efecto de doble sombra neón (Blue/Pink) */
            text-shadow: 
                0 0 10px var(--neon-blue), /* Primer capa de brillo azul */
                0 0 20px var(--neon-pink), /* Segunda capa de brillo rosa */
                0 0 30px var(--neon-blue); /* Tercer capa para mayor intensidad */
                
            /* Animación sutil */
            animation: pura-vida-flicker 4s infinite alternate ease-in-out;
            transition: all 0.5s;
        }

        @keyframes pura-vida-flicker {
            0%, 100% {
                text-shadow: 
                    0 0 10px var(--neon-blue), 
                    0 0 20px var(--neon-pink);
            }
            50% {
                text-shadow: 
                    0 0 15px var(--neon-pink), 
                    0 0 25px var(--neon-blue);
                transform: scale(1.02);
            }
        }
        
        /* Controles */
        .player-controls {
            width: 100%;
            display: flex;
            flex-direction: row; 
            justify-content: center; 
            align-items: center;
            gap: 30px; 
            margin-top: 10px;
        }

        /* Efecto de pulso en los iconos de volumen */
        .volume-control i {
            transition: all 0.3s ease;
            text-shadow: 0 0 5px var(--neon-blue); 
            cursor: pointer; 
        }

        .radio-player.playing .volume-control i {
            animation: icon-pulse 1.5s infinite alternate;
        }

        @keyframes icon-pulse {
            0% {
                text-shadow: 0 0 5px var(--neon-blue), 0 0 10px var(--neon-pink);
            }
            100% {
                text-shadow: 0 0 10px var(--neon-pink), 0 0 20px var(--neon-blue);
                transform: scale(1.05);
            }
        }

        /* Botón Play/Pause */
        #play-pause-btn {
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-pink));
            color: var(--dark-bg);
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            min-width: 80px; 
            min-height: 80px;
            font-size: 2.5em;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 0 20px var(--neon-blue), 0 0 40px var(--neon-pink);
            transition: all 0.2s ease;
        }

        #play-pause-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px var(--neon-blue), 0 0 60px var(--neon-pink);
        }
        
        /* Controles de volumen */
        .volume-control {
            width: 50%; 
            max-width: 250px; 
            display: flex;
            align-items: center;
            gap: 10px; 
            padding: 0; 
            text-shadow: 0 0 5px var(--neon-blue);
        }

        /* Slider de volumen personalizado */
        #volume-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 12px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            outline: none;
            transition: background 0.2s;
            box-shadow: 0 0 5px rgba(0, 224, 255, 0.5);
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-pink));
            cursor: pointer;
            box-shadow: 0 0 10px var(--neon-blue);
        }
        
        #volume-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-pink));
            cursor: pointer;
            box-shadow: 0 0 10px var(--neon-blue);
            border: none;
        }

        /* Media Queries para Responsividad Móvil */
        @media (max-width: 600px) {
            .radio-player {
                width: 100vw;
                height: 100vh;
                max-height: none; 
                padding: 15px;
                border-radius: 0;
            }

            #orb-wrapper {
                width: 70vw;
                height: 70vw;
                max-width: 90%;
                max-height: 90%;
            }

            #song-title {
                font-size: 1.2em;
            }
            
            #pura-vida-text {
                font-size: 1.8em;
            }

            /* Vuelve a apilar controles en móvil */
            .player-controls {
                flex-direction: column; 
                gap: 15px; 
            }
            
            .volume-control {
                width: 100%; 
                max-width: none;
                padding: 0 10px;
            }

            #play-pause-btn {
                width: 65px;
                height: 65px;
                font-size: 2em;
            }
            
            .volume-control {
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    
    <div class="radio-player">
        <div class="metadata-top">
            <div id="current-date">--</div>
            <div id="current-time">--</div>
        </div>
        
        <audio id="audio-player" src="https://stream.zeno.fm/yhlu3rhvuiavv" preload="auto"></audio>
        
        <div class="visualizer-area">
            <!-- Contenedor del Orbe -->
            <div id="orb-wrapper">
                <div id="visualizer-orb"></div>
            </div>
            
            <!-- Título de la Canción (puede ser Marquee) -->
            <div class="marquee-container" id="title-container">
                <h2 id="song-title">Cargando Radio Zeno...</h2>
            </div>
            
            <!-- NUEVO: Frase "PURA VIDA" con estilo neón espectacular -->
            <h1 id="pura-vida-text">PURA VIDA</h1>
        </div>
        
        <div class="player-controls">
            <!-- Botón Play/Pause -->
            <button id="play-pause-btn" aria-label="Reproducir o Pausar">
                <i id="play-icon" class="fas fa-play"></i>
                <i id="pause-icon" class="fas fa-pause" style="display:none;"></i>
            </button>

            <!-- Control de Volumen -->
            <div class="volume-control">
                <i id="volume-low-icon" class="fas fa-volume-down" style="color: var(--neon-blue);"></i>
                <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.5" aria-label="Control de Volumen">
                <i id="volume-high-icon" class="fas fa-volume-up" style="color: var(--neon-pink);"></i>
            </div>
        </div>
        
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const audioPlayer = document.getElementById('audio-player');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const playIcon = document.getElementById('play-icon');
            const pauseIcon = document.getElementById('pause-icon');
            const songTitle = document.getElementById('song-title');
            const volumeSlider = document.getElementById('volume-slider');
            const volumeLowIcon = document.getElementById('volume-low-icon');
            const volumeHighIcon = document.getElementById('volume-high-icon'); 
            const currentDateEl = document.getElementById('current-date');
            const currentTimeEl = document.getElementById('current-time');
            const radioPlayer = document.querySelector('.radio-player');
            const titleContainer = document.getElementById('title-container');
            
            const metadataUrl = "https://api.zeno.fm/mounts/metadata/subscribe/yhlu3rhvuiavv";
            let currentTrackTitle = ""; 
            let lastVolume = 0.5; 

            // 1. Inicializar y actualizar fecha/hora
            function updateDateTime() {
                const now = new Date();
                const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
                const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
                
                currentDateEl.textContent = now.toLocaleDateString('es-ES', dateOptions).toUpperCase();
                currentTimeEl.textContent = now.toLocaleTimeString('es-ES', timeOptions);
            }
            
            setInterval(updateDateTime, 1000);
            updateDateTime();

            // 2. Control de reproducción (Play/Pause)
            playPauseBtn.addEventListener('click', () => {
                if (audioPlayer.paused) {
                    audioPlayer.play().catch(error => {
                        console.error("Error al intentar reproducir el audio:", error);
                        songTitle.textContent = "Error de reproducción. Toca para reintentar.";
                    });
                    playIcon.style.display = 'none';
                    pauseIcon.style.display = 'inline';
                    radioPlayer.classList.add('playing');
                } else {
                    audioPlayer.pause();
                    playIcon.style.display = 'inline';
                    pauseIcon.style.display = 'none';
                    radioPlayer.classList.remove('playing');
                }
            });
            
            // 3. Lógica de Silencio (Mute/Unmute)
            function toggleMute() {
                if (audioPlayer.volume > 0) {
                    lastVolume = audioPlayer.volume;
                    audioPlayer.volume = 0;
                    volumeSlider.value = 0;
                    volumeLowIcon.classList.replace('fa-volume-down', 'fa-volume-off');
                } else {
                    const targetVolume = lastVolume > 0.05 ? lastVolume : 0.5; 
                    audioPlayer.volume = targetVolume;
                    volumeSlider.value = targetVolume;
                    volumeLowIcon.classList.replace('fa-volume-off', 'fa-volume-down');
                }
            }

            // 4. Control de Volumen
            audioPlayer.volume = volumeSlider.value; 

            volumeSlider.addEventListener('input', (event) => {
                const newVolume = parseFloat(event.target.value);
                audioPlayer.volume = newVolume;
                
                if (newVolume > 0) {
                    lastVolume = newVolume;
                    volumeLowIcon.classList.replace('fa-volume-off', 'fa-volume-down');
                } else {
                    volumeLowIcon.classList.replace('fa-volume-down', 'fa-volume-off');
                }
            });

            // Conectar la funcionalidad de mute/unmute a los iconos
            volumeLowIcon.addEventListener('click', toggleMute);
            volumeHighIcon.addEventListener('click', toggleMute);


            // 5. Obtener Metadatos (Título de la Canción)
            function getSongInfo() {
                if (window.EventSource) {
                    const source = new EventSource(metadataUrl);
                    
                    source.onmessage = function(event) {
                        try {
                            const data = JSON.parse(event.data);
                            if (data.streamTitle && data.streamTitle !== currentTrackTitle) {
                                currentTrackTitle = data.streamTitle; 
                                songTitle.textContent = currentTrackTitle;
                                applyMarquee(songTitle, titleContainer);
                            }
                        } catch (e) {
                            console.warn("Advertencia: Datos de metadatos no son JSON válido o están vacíos.", e);
                            songTitle.textContent = "Transmisión en vivo (ZENO.FM)";
                            applyMarquee(songTitle, titleContainer);
                        }
                    };
                    
                    source.onerror = function(event) {
                        console.error("Error en la conexión con la API de metadatos:", event);
                        songTitle.textContent = "Error al conectar con el servidor de metadatos.";
                        source.close();
                    };
                } else {
                    songTitle.textContent = "Error: EventSource no soportado.";
                }
            }

            // Lógica corregida para aplicar el efecto Marquee
            function applyMarquee(titleElement, containerElement) {
                setTimeout(() => {
                    titleElement.style.transform = 'translateY(-50%)'; 
                    containerElement.classList.remove('marquee-active');
                    
                    titleElement.style.position = 'relative';
                    titleElement.style.left = '0';
                    titleElement.style.width = 'fit-content'; 
                    
                    const contentWidth = titleElement.scrollWidth;
                    const containerWidth = containerElement.clientWidth;

                    if (contentWidth > containerWidth) {
                        const totalScrollDistance = contentWidth + containerWidth; 
                        const speedPxPerSecond = 40; 
                        const duration = totalScrollDistance / speedPxPerSecond;
                        
                        titleElement.style.setProperty('--scroll-distance', `-${totalScrollDistance}px`);
                        titleElement.style.setProperty('--scroll-duration', `${duration}s`);

                        containerElement.classList.add('marquee-active');
                        
                    } else {
                        titleElement.style.width = '100%';
                        titleElement.style.textAlign = 'center';
                        titleElement.style.position = 'relative'; 
                        titleElement.style.left = '0';
                        titleElement.style.transform = 'translateY(-50%)'; 
                    }
                }, 100); 
            }
            
            // Iniciar la obtención de metadatos
            getSongInfo();

            // Re-evaluar el marquee en caso de redimensionamiento
            window.addEventListener('resize', () => applyMarquee(songTitle, titleContainer));
        });
    </script>
</body>
</html>
